from google.colab import drive
drive.mount('/content/drive')

# 4 F
def aminoMassTable():
    aminoMass = {
        'G': 57,
        'A': 71,
        'S': 87,
        'P': 97,
        'V': 99,
        'T': 101,
        'C': 103,
        'I': 113,
        'L': 113,
        'N': 114,
        'D': 115,
        'K': 128,
        'Q': 128,
        'E': 129,
        'M': 131,
        'H': 137,
        'F': 147,
        'R': 156,
        'Y': 163,
        'W': 186
    }
    return aminoMass

def cyclicSpectrum(peptide):
    aminoMassT = aminoMassTable()
    prefixMass = {
        0: 0
    }
    for i in range(len(peptide)):
        for j in range(20):
            if(list(aminoMassT.keys())[j] == peptide[i]):
                prefixMass[i + 1] = prefixMass[i] + aminoMassT[peptide[i]]
    peptideMass = prefixMass[len(peptide)]
    cyclicSpc = [0]
    for i in range(len(peptide)):
        for j in range(i + 1, len(peptide) + 1):
            cyclicSpc.append(prefixMass[j] - prefixMass[i])
            if(i > 0 and j < len(peptide)):
                cyclicSpc.append(peptideMass - (prefixMass[j] - prefixMass[i]))
    return sorted(cyclicSpc)

peptide = "FQFDVWFFEYIEVAKKNEEDWVIFSNTSAYLCDTCHTELYA"
expMass = "0 71 71 71 71 87 97 97 99 99 101 101 103 103 113 113 113 113 114 115 115 115 115 128 128 129 129 129 129 129 137 147 147 147 147 147 147 158 163 163 163 170 186 186 188 199 200 204 208 210 214 215 216 216 218 218 226 228 229 234 234 240 242 244 256 258 259 260 260 260 260 262 262 275 276 276 276 276 283 285 292 294 297 298 299 301 302 311 319 319 321 327 330 331 331 331 333 337 341 341 347 357 361 373 373 375 375 376 379 381 389 396 398 400 403 404 405 405 405 407 412 412 417 422 422 423 426 427 430 432 432 434 434 439 440 450 456 460 460 472 474 474 477 478 478 480 488 489 494 494 504 511 520 522 527 527 531 532 533 534 535 535 536 537 537 540 541 543 547 547 552 555 559 559 564 565 573 575 579 586 586 590 591 593 595 597 603 607 609 621 630 633 635 638 638 640 641 648 649 651 652 656 656 658 658 660 661 666 668 668 672 677 678 681 687 692 694 694 698 699 700 702 702 703 704 706 708 720 732 738 743 748 752 753 753 753 756 759 764 769 769 771 772 772 773 774 776 780 787 791 798 801 803 807 807 815 815 823 828 831 831 831 832 834 835 841 845 847 851 853 854 855 856 856 867 867 867 871 872 872 873 878 885 887 902 906 906 911 911 916 916 916 918 927 928 931 938 944 946 952 954 954 957 960 960 960 962 968 969 970 977 978 979 982 982 984 986 987 988 993 998 1008 1014 1014 1016 1019 1019 1024 1025 1031 1031 1031 1033 1035 1041 1044 1053 1059 1063 1064 1071 1073 1075 1075 1075 1081 1083 1083 1090 1094 1099 1101 1106 1107 1107 1107 1113 1113 1117 1121 1126 1127 1129 1130 1132 1132 1132 1132 1133 1134 1138 1145 1146 1152 1165 1172 1172 1178 1178 1184 1186 1188 1188 1190 1191 1193 1194 1203 1203 1204 1208 1212 1224 1228 1229 1230 1230 1236 1236 1237 1242 1243 1246 1246 1246 1247 1254 1254 1261 1267 1275 1279 1279 1283 1285 1289 1290 1292 1293 1294 1295 1301 1306 1307 1309 1312 1319 1323 1327 1333 1333 1335 1338 1339 1342 1343 1350 1350 1351 1358 1359 1365 1366 1366 1374 1375 1383 1390 1391 1392 1393 1393 1394 1394 1394 1398 1401 1404 1408 1410 1411 1414 1420 1422 1432 1434 1437 1438 1440 1440 1446 1453 1463 1464 1464 1470 1471 1471 1474 1475 1480 1480 1485 1488 1489 1493 1497 1505 1505 1506 1509 1512 1513 1521 1523 1524 1525 1525 1526 1530 1537 1539 1541 1543 1545 1548 1551 1551 1554 1561 1561 1567 1577 1578 1583 1584 1584 1587 1587 1604 1608 1608 1610 1612 1618 1619 1620 1622 1625 1626 1626 1627 1627 1632 1634 1635 1640 1649 1654 1654 1654 1658 1659 1666 1668 1670 1671 1673 1679 1679 1680 1680 1686 1690 1697 1706 1711 1714 1716 1718 1720 1724 1725 1725 1729 1731 1733 1734 1736 1739 1740 1741 1747 1751 1761 1763 1767 1769 1769 1772 1773 1774 1783 1783 1783 1784 1786 1794 1801 1801 1805 1805 1807 1807 1813 1815 1819 1824 1826 1827 1837 1842 1844 1844 1845 1846 1847 1853 1854 1866 1869 1870 1872 1876 1876 1878 1880 1880 1885 1886 1888 1894 1897 1898 1898 1906 1910 1914 1924 1930 1930 1930 1931 1933 1937 1941 1944 1948 1948 1955 1959 1960 1960 1960 1966 1966 1968 1970 1973 1973 1977 1977 1981 1987 1999 1999 2001 2001 2001 2004 2009 2010 2023 2023 2032 2035 2037 2039 2041 2043 2044 2045 2046 2052 2057 2058 2058 2059 2059 2061 2061 2061 2061 2065 2066 2077 2083 2088 2095 2102 2102 2106 2110 2114 2114 2123 2132 2136 2138 2140 2140 2145 2146 2146 2146 2147 2148 2148 2154 2157 2163 2164 2166 2167 2170 2170 2173 2173 2174 2174 2181 2181 2186 2190 2191 2194 2206 2208 2211 2217 2219 2224 2239 2243 2244 2245 2246 2249 2252 2253 2257 2261 2261 2261 2261 2264 2265 2265 2265 2269 2274 2277 2278 2279 2285 2295 2301 2303 2304 2310 2310 2311 2317 2319 2320 2320 2321 2326 2331 2336 2337 2342 2353 2356 2356 2358 2360 2360 2372 2374 2376 2377 2378 2380 2382 2382 2382 2386 2391 2392 2393 2397 2399 2402 2402 2406 2407 2408 2408 2432 2432 2433 2434 2439 2440 2441 2442 2455 2457 2457 2464 2466 2467 2471 2471 2473 2473 2475 2478 2483 2485 2493 2495 2500 2503 2505 2505 2507 2507 2511 2512 2514 2521 2521 2523 2536 2537 2538 2539 2544 2545 2546 2546 2570 2570 2571 2572 2576 2576 2579 2581 2585 2586 2587 2592 2596 2596 2596 2598 2600 2601 2602 2604 2606 2618 2618 2620 2622 2622 2625 2636 2641 2642 2647 2652 2657 2658 2658 2659 2661 2667 2668 2668 2674 2675 2677 2683 2693 2699 2700 2701 2704 2709 2713 2713 2713 2714 2717 2717 2717 2717 2721 2725 2726 2729 2732 2733 2734 2735 2739 2754 2759 2761 2767 2770 2772 2784 2787 2788 2792 2797 2797 2804 2804 2805 2805 2808 2808 2811 2812 2814 2815 2821 2824 2830 2830 2831 2832 2832 2832 2833 2838 2838 2840 2842 2846 2855 2864 2864 2868 2872 2876 2876 2883 2890 2895 2901 2912 2913 2917 2917 2917 2917 2919 2919 2920 2920 2921 2926 2932 2933 2934 2935 2937 2939 2941 2943 2946 2955 2955 2968 2969 2974 2977 2977 2977 2979 2979 2991 2997 3001 3001 3005 3005 3008 3010 3012 3012 3018 3018 3018 3019 3023 3030 3030 3034 3037 3041 3045 3047 3048 3048 3048 3054 3064 3068 3072 3080 3080 3081 3084 3090 3092 3093 3098 3098 3100 3102 3102 3106 3108 3109 3112 3124 3125 3131 3132 3133 3134 3134 3136 3141 3151 3152 3154 3159 3163 3165 3171 3171 3173 3173 3177 3177 3184 3192 3194 3195 3195 3195 3204 3205 3206 3209 3209 3211 3215 3217 3227 3231 3237 3238 3239 3242 3244 3245 3247 3249 3253 3253 3254 3258 3260 3262 3264 3267 3272 3281 3288 3292 3298 3298 3299 3299 3305 3307 3308 3310 3312 3319 3320 3324 3324 3324 3329 3338 3343 3344 3346 3351 3351 3352 3352 3353 3356 3358 3359 3360 3366 3368 3370 3370 3374 3391 3391 3394 3394 3395 3400 3401 3411 3417 3417 3424 3427 3427 3430 3433 3435 3437 3439 3441 3448 3452 3453 3453 3454 3455 3457 3465 3466 3469 3472 3473 3473 3481 3485 3489 3490 3493 3498 3498 3503 3504 3507 3507 3508 3514 3514 3515 3525 3532 3538 3538 3540 3541 3544 3546 3556 3558 3564 3567 3568 3570 3574 3577 3580 3584 3584 3584 3585 3585 3586 3587 3588 3595 3603 3604 3612 3612 3613 3619 3620 3627 3628 3628 3635 3636 3639 3640 3643 3645 3645 3651 3655 3659 3666 3669 3671 3672 3677 3683 3684 3685 3686 3688 3689 3693 3695 3699 3699 3703 3711 3717 3724 3724 3731 3732 3732 3732 3735 3736 3741 3742 3742 3748 3748 3749 3750 3754 3766 3770 3774 3775 3775 3784 3785 3787 3788 3790 3790 3792 3794 3800 3800 3806 3806 3813 3826 3832 3833 3840 3844 3845 3846 3846 3846 3846 3848 3849 3851 3852 3857 3861 3865 3865 3871 3871 3871 3872 3877 3879 3884 3888 3895 3895 3897 3903 3903 3903 3905 3907 3914 3915 3919 3925 3934 3937 3943 3945 3947 3947 3947 3953 3954 3959 3959 3962 3964 3964 3970 3980 3985 3990 3991 3992 3994 3996 3996 3999 4000 4001 4008 4009 4010 4016 4018 4018 4018 4021 4024 4024 4026 4032 4034 4040 4047 4050 4051 4060 4062 4062 4062 4067 4067 4072 4072 4076 4091 4093 4100 4105 4106 4106 4107 4111 4111 4111 4122 4122 4123 4124 4125 4127 4131 4133 4137 4143 4144 4146 4147 4147 4147 4150 4155 4163 4163 4171 4171 4175 4177 4180 4187 4191 4198 4202 4204 4205 4206 4206 4207 4209 4209 4214 4219 4222 4225 4225 4225 4226 4230 4235 4240 4246 4258 4270 4272 4274 4275 4276 4276 4278 4279 4280 4284 4284 4286 4291 4297 4300 4301 4306 4310 4310 4312 4317 4318 4320 4320 4322 4322 4326 4327 4329 4330 4337 4338 4340 4340 4343 4345 4348 4357 4369 4371 4375 4381 4383 4385 4387 4388 4392 4392 4399 4403 4405 4413 4414 4419 4419 4423 4426 4431 4431 4435 4437 4438 4441 4441 4442 4443 4443 4444 4445 4446 4447 4451 4451 4456 4458 4467 4474 4484 4484 4489 4490 4498 4500 4500 4501 4504 4504 4506 4518 4518 4522 4528 4538 4539 4544 4544 4546 4546 4548 4551 4552 4555 4556 4556 4561 4566 4566 4571 4573 4573 4573 4574 4575 4578 4580 4582 4589 4597 4599 4602 4603 4603 4605 4605 4617 4621 4631 4637 4637 4641 4645 4647 4647 4647 4648 4651 4657 4659 4659 4667 4676 4677 4679 4680 4681 4684 4686 4693 4695 4702 4702 4702 4702 4703 4716 4716 4718 4718 4718 4718 4719 4720 4722 4734 4736 4738 4744 4744 4749 4750 4752 4760 4760 4762 4762 4763 4764 4768 4770 4774 4778 4779 4790 4792 4792 4808 4815 4815 4815 4820 4831 4831 4831 4831 4831 4831 4841 4849 4849 4849 4849 4849 4850 4850 4863 4863 4863 4863 4864 4865 4865 4865 4865 4875 4875 4877 4877 4879 4879 4881 4881 4891 4907 4907 4907 4907 4978"

expMass = expMass.split(" ")
ls = cyclicSpectrum(peptide)
print(ls)
ls = list(map(str, ls))

from collections import Counter

counter1 = Counter(expMass)
counter2 = Counter(ls)

print(counter2)
common_elements = counter1 & counter2
a=list(common_elements.values())
print("")
print(a)
sum=0
for i in a:
  sum+=i

print(sum)
